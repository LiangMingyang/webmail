<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title></title>
</head>
<body>
<!--tab-->
<div id="tmp-tab">
  <div class="tab" id="${id}"><span class="name">${name}</span><i class="icon-close"></i></div>
</div>

<div id="tmp-tab-page">
  <section class="tab-page" id="${id}">

  </section>
</div>
<div id="tmp-editor-page">
  <div class="editor-block">
    <div class="row top-row">
      <div class="btn-wrapper">
        <span class="btn radiusBtn square auto style_1" id="send-mail-${id}">发送</span>
        <span class="btn radiusBtn square auto style_1 ghostBtn">取消</span>
      </div>
    </div>
    <div class="row">
      <span class="txt title-left">邮件地址</span>

      <div class="col col-right">
        <div type="text" class="input input-mail-to" id="mail-to-${id}" contenteditable="true" data-mail-id="${mail.id}">${mail.from}</div>
        <div class="icon-remove"></div>
        <input type="hidden" class="input-mail-to-hidden"/>
      </div>
    </div>
    <div>

    </div>
    <div class="row">
      <span class="txt title-left">主题</span>

      <div type="text" class="input input-theme" id="mail-title-${id}" contenteditable="true">${mail.title}</div>
    </div>
    <div class="row p-adm">
      <span class="txt title-left">标签分类</span>
      <div class="tag-wrapper">
        <div class="mail-tag add">
          <div class="icon-add-tag"></div>
          <span class="txt" contenteditable="true"></span>
        </div>
        <div class="btn radiusBtn square auto style_1 commit" id="tag-commit">保存分类</div>
      </div>
    </div>
    <div class="row editor-area">
      <span class="txt title-left">邮件正文</span>

      <div class="right-textarea">
        <div class="mail-html">$${mail.html}</div>

        <textarea class="mail-content p-con" id="mail-textarea-${id}">输入您的邮件正文</textarea>

        <div class="marked-view markdown-body p-con" id="mail-marked-${id}"></div>
      </div>
    </div>
  </div>
</div>

<div id="tmp-people-manage">
  <!--
    {@helper getPrivilege}
      function(name){
        var arr = ['consumer','dispatcher','auditor','admin'];
        var zh  = ['处理人员','分发人员','审核人员','管理员'];
        var index1 = arr.indexOf(name);
        var index2 = zh.indexOf(name);
        if(index1 > -1 ){
          return zh[index1];
        }else {
          return arr[index2];
        }
      }
    {@/helper}
    {@helper time}
      function(time){
        var d = new Date(time);
        return d.toLocaleString();
      }
    {@/helper}
    -->
  <div id="people-manage">
    {@each users as p}

    <div class="m-user-wrapper user" id="admin-user-${p.id}" data-id="${p.id}">
      <div class="user-name">
        <span class="m-username">用户：${p.username}</span>

        <div class="drop-arrow">
          <div class="drop-menu">
            <div class="item user-save" id="user-save-${p.id}" data-id="${p.id}">保存</div>
            <div class="item user-delete" id="user-delete-${p.id}" data-id="${p.id}">删除</div>
            <div class="item user-cancel" id="user-cancel-${p.id}" data-id="${p.id}">取消</div>
          </div>
        </div>
      </div>
      <div class="create-time">${p.createdAt|time}</div>
      <div class="password form hide">
        <input type="password" class="form-text inline-ele  pwd-input" placeholder="输入新密码"/>
      </div>
      <div class="intro">
        <span class="privilege ">${p.privilege|getPrivilege}</span>

        <div class="user-privilege-list">
          <div class="privilege-item" data-privilege="consumer" data-id="${p.id}">处理</div>
          <div class="privilege-item" data-privilege="dispatcher" data-id="${p.id}">分派</div>
          <div class="privilege-item" data-privilege="auditor" data-id="${p.id}">审核</div>
          <div class="privilege-item" data-privilege="admin" data-id="${p.id}">管理</div>
        </div>
      </div>
      <div class="operation">
        <a class="txt user-pwd" id="user-pwd-${p.id}" data-id="${p.id}">修改密码</a>
        <span class="txt">|</span>
        <a class="txt user-privilege" id="user-privilege-${p.id}" data-id="${p.id}">修改权限</a>
      </div>
    </div>
    {@/each}

    <div class="m-user-wrapper add" data-id="0">
      <div class="user-name">
        <span class="m-username" contenteditable="true">输入用户名</span>

        <div class="drop-arrow">
          <div class="drop-menu">
            <div class="item user-save" id="user-save-0" data-id="0">保存</div>
            <div class="item user-delete" id="user-delete-0" data-id="0">删除</div>
            <div class="item user-cancel" id="user-cancel-0" data-id="0">取消</div>
          </div>
        </div>
      </div>
      <div class="password form">
        <input type="password" class="form-text inline-ele pwd-input" placeholder="输入新密码"/>
      </div>
      <div class="intro change">
        <span class="privilege">请选择</span>

        <div class="user-privilege-list">
          <div class="privilege-item" data-privilege="consumer" data-id="0">处理</div>
          <div class="privilege-item" data-privilege="dispatcher" data-id="0">分派</div>
          <div class="privilege-item" data-privilege="auditor" data-id="0">审核</div>
          <div class="privilege-item" data-privilege="admin" data-id="0">管理</div>
        </div>
      </div>
      <div class="operation">
        <a class="txt user-pwd" id="user-pwd-0" data-id="0">修改密码</a>
        <span class="txt">|</span>
        <a class="txt user-privilege" id="user-privilege-0" data-id="0">修改权限</a>
      </div>
    </div>
  </div>
</div>

<div id="tmp-user-wrapper">
  <div class="user-name">
    <span class="m-username">用户：${p.username}</span>

    <div class="drop-arrow">
      <div class="drop-menu">
        <div class="item user-save" id="user-save-${p.id}" data-id="${p.id}">保存</div>
        <div class="item user-delete" id="user-delete-${p.id}" data-id="${p.id}">删除</div>
        <div class="item user-cancel" id="user-cancel-${p.id}" data-id="${p.id}">取消</div>
      </div>
    </div>
  </div>
  <div class="create-time">${p.createdAt|time}</div>
  <div class="password form hide">
    <input type="password" class="form-text inline-ele" placeholder="输入新密码"/>
  </div>
  <div class="intro">
    <span class="privilege ">${p.privilege|getPrivilege}</span>

    <div class="user-privilege-list">
      <div class="privilege-item" data-privilege="consumer">处理</div>
      <div class="privilege-item" data-privilege="dispatcher">分派</div>
      <div class="privilege-item" data-privilege="auditor">审核</div>
      <div class="privilege-item" data-privilege="admin">管理</div>
    </div>
  </div>
  <div class="operation">
    <a class="txt user-pwd" id="user-pwd-${p.id}" data-id="${p.id}">修改密码</a>
    <span class="txt">|</span>
    <a class="txt user-privilege" id="user-privilege-${p.id}" data-id="${p.id}">修改权限</a>
  </div>
</div>


<div id="tmp-add-user">
  <div class="m-user-wrapper add" data-id="0">
    <div class="user-name">
      <span class="m-username" contenteditable="true">输入用户名</span>

      <div class="drop-arrow">
        <div class="drop-menu">
          <div class="item user-save" id="user-save-0" data-id="0">保存</div>
          <div class="item user-delete" id="user-delete-0" data-id="0">删除</div>
          <div class="item user-cancel" id="user-cancel-0" data-id="0">取消</div>
        </div>
      </div>
    </div>
    <div class="password form">
      <input type="password" class="form-text inline-ele  pwd-input" placeholder="输入新密码"/>
    </div>
    <div class="intro change">
      <span class="privilege">请选择</span>

      <div class="user-privilege-list">
        <div class="privilege-item" data-privilege="consumer" data-id="0">处理</div>
        <div class="privilege-item" data-privilege="dispatcher" data-id="0">分派</div>
        <div class="privilege-item" data-privilege="auditor" data-id="0">审核</div>
        <div class="privilege-item" data-privilege="admin" data-id="0">管理</div>
      </div>
    </div>
    <div class="operation">
      <a class="txt user-pwd" id="user-pwd-0" data-id="0">修改密码</a>
      <span class="txt">|</span>
      <a class="txt user-privilege" id="user-privilege-0" data-id="0">修改权限</a>
    </div>
  </div>
</div>


<div id="tmp-mail-list-item">
  <!--
  {@helper headClass}
    function(text){
      return (text.length)%20;
    }
  {@/helper}

   {@helper date}
      function(time){
        var d = new Date(time);
        return (d.getMonth()+1)+'月'+d.getDate()+'日';
      }
   {@/helper}

   {@helper pureTxt}
      function (html){
        html = html.replace(/<\/?[^>]+(>|$)/g, "").replace(/\&nbsp;/g, '');
        html = html.slice(0,40);
        html += "...";

        return html;
      }
   {@/helper}
  -->
  <div class="mail" data-id="${mail.id}">
    <div class="mail-from-head" data-head="${mail.from|headClass}">
      <div class="user-head-icon user-head-${mail.from|headClass}"></div>
    </div>
    <div class="mail-content">
      <div class="mail-from">
        <span class="txt">${mail.from}</span>
      </div>
      <div class="mail-title">
        <span class="txt">${mail.title}</span>
      </div>
      <div class="mail-details">
        <span class="txt">${mail.createdAt|date}</span>
      </div>
      <div class="mail-html">
        $${mail.html|pureTxt}
      </div>
    </div>
  </div>
</div>

<div id="tmp-mail-detail">
  <div class="mail-detail">
    <div class="row">
      <span class="txt title-left">发件人</span>
      <span class="link">${mail.from}</span>
    </div>
    <div class="row">
      <span class="txt title-left">主题</span>
      <span class="link">${mail.title}</span>
    </div>
    <div class="row">
      <span class="txt title-left">操作</span>

      <div class="manu-col">
        <div class="btn radiusBtn square style_1 auto p-adm">分类</div>
        <div class="btn radiusBtn square style_1 auto p-dis">分发</div>
        <div class="btn radiusBtn square style_1 auto p-con">回复</div>
        <div class="btn radiusBtn square style_1 auto p-aud">审核</div>
      </div>
    </div>
    <div class="row editor-area">
      <span class="txt title-left">邮件正文</span>

      <div class="right-textarea">
        <div class="mail-html">$${mail.html}</div>

      </div>
    </div>
  </div>
</div>

<div id="tmp-mail-detail">
  <div class="mail-detail">
    <div class="row">
      <span class="txt title-left">发件人</span>
      <span class="link">${mail.from}</span>
    </div>
    <div class="row">
      <span class="txt title-left">主题</span>
      <span class="link">${mail.title}</span>
    </div>
    <div class="row">
      <span class="txt title-left">操作</span>

      <div class="manu-col">
        <div class="btn radiusBtn square style_1 auto p-adm">分类</div>
        <div class="btn radiusBtn square style_1 auto p-dis">分发</div>
        <div class="btn radiusBtn square style_1 auto p-con">回复</div>
        <div class="btn radiusBtn square style_1 auto p-aud">审核</div>
      </div>
    </div>
    <div class="row editor-area">
      <span class="txt title-left">邮件正文</span>

      <div class="right-textarea">
        <div class="mail-html">$${mail.html}</div>
      </div>
    </div>
  </div>
</div>


<div id="tmp-mail-list-page">
  <div id="mail-list-wrapper">
    <section class="left-mail-list show left-mail-list">
      <i class="hide-btn mail-list-toggle-btn" title="收起列表"></i>
      <header class="list-header">
        <span class="title mail-list-title">收件箱</span>
      </header>
      <div class="mails-wrapper">
        <div class="mail load-more">加载更多</div>
      </div>
    </section>
    <div class="right-detail-section">

    </div>
  </div>
</div>



<div id="tmp-inbox">
  <div>
    <section class="left-mail-list show">
      <i class="hide-btn mail-list-toggle-btn" title="收起列表"></i>
      <header class="list-header">
        <span class="title mail-list-title">收件箱</span>
      </header>
      <div class="mails-wrapper">
        <div class="mail load-more">加载更多</div>
      </div>
    </section>
    <div class="right-detail-section">

    </div>
  </div>
</div>




<div id="tmp-outbox">
  <div>
    <section class="left-mail-list show">
      <i class="hide-btn mail-list-toggle-btn" title="收起列表"></i>
      <header class="list-header">
        <span class="title mail-list-title">收件箱</span>
      </header>
      <div class="mails-wrapper">
        <div class="mail load-more">加载更多</div>
      </div>
    </section>
    <div class="right-detail-section">

    </div>
  </div>
</div>



<div id="tmp-dispatch">
  <div id="dispatch-wrapper">
    <section class="left-mail-list show left-mail-list">
      <i class="hide-btn mail-list-toggle-btn" title="收起列表"></i>
      <header class="list-header">
        <span class="title mail-list-title">收件箱</span>
      </header>
      <div class="mails-wrapper">
        <div class="mail load-more">加载更多</div>
      </div>
    </section>
    <div class="right-detail-section">

    </div>
  </div>
</div>

<div id="tmp-dispatch-mail-detail">
  <div class="mail-detail dispatch-mail-detail">
    <div class="row">
      <span class="txt title-left">发件人</span>
      <span class="link">${mail.from}</span>
    </div>
    <div class="row">
      <span class="txt title-left">主题</span>
      <span class="link">${mail.title}</span>
    </div>
    <div class="row p-dis">
      <span class="txt title-left">分派</span>
      <div class="receiver-wrapper">
        <select id="select-dispatch-number" class="user"  multiple="multiple"></select>
        <div class="btn radiusBtn square auto style_1 commit" id="dispatch-commit">现在分发</div>
      </div>
    </div>
    <div class="row p-adm">
      <span class="txt title-left">贴标签</span>
      <div class="receiver-wrapper">
        <select id="select-tag-to-stick" class="user"  multiple="multiple"></select>
        <div class="btn radiusBtn square auto style_1 commit" id="stick-tag-commit">确认添加</div>
      </div>
    </div>
    <div class="row editor-area">
      <span class="txt title-left">邮件正文</span>

      <div class="right-textarea">
        <div class="mail-html">$${mail.html}</div>

      </div>
    </div>
  </div>
</div>

<div id="tmp-mail-tag">
  <div class="mail-tag add">
    <div class="icon-add-tag"></div>
    <span class="txt" contenteditable="true"></span>
  </div>
</div>
<div id="tmp-mail-receiver">
  <div class="mail-receiver add" >
    <div class="icon-add-receiver"></div>
    <span class="txt" contenteditable="true"></span>
  </div>
</div>

<div id="tmp-user-list">

  <optgroup label="管理员">

  {@each admin as u}
    <option value="${u.id}">${u.username}</option>
  {@/each}
  </optgroup>

  <optgroup label="处理人员">
    {@each consumer as u}
    <option value="${u.id}">${u.username}</option>
    {@/each}
  </optgroup>

  <optgroup label="分发人员">

    {@each dispatcher as u}
    <option value="${u.id}">${u.username}</option>
    {@/each}

  </optgroup>

  <optgroup label="审核人员">
    {@each auditor as u}
    <option value="${u.id}">${u.username}</option>
    {@/each}
  </optgroup>

</div>

<div id="tmp-tags-drop">
  {@each tags as t}
  <option value="${t.id}">${t.content}</option>
  {@/each}
</div>

<script id="tmp-tag-manage" type="text/html">
  <div id="tag-manage-page">
    <table id="tags-table" class="table">
      <thead>
      <tr>
        <th width="300">id</th>
        <th width="300">名称</th>
        <th width="300">操作</th>
      </tr>
      </thead>
      <tbody>
        <tr>
          <td>

          </td>
          <td>
            <input type="text" class="form-text inline-ele" id="f-add-tag-name" placeholder="请输入您要添加的标签名"/>
          </td>
          <td>
            <span class="btn radiusBtn style_1 square auto p-adm f-add-tag-btn" id="f-add-tag-btn">添加标签</span>
          </td>
        </tr>

      {@each tags as t}

        <tr id="tag-manage-tr-${t.id}">
          <td>
            <span>${t.id}</span>
          </td>
          <td>
            <span>${t.content}</span>
          </td>
          <td>
            <span class="btn radiusBtn style_8 square auto p-adm f-del-tag" id="f-del-tag-${t.id}" data-id="${t.id}">删除</span>
          </td>
        </tr>

      {@/each}

      </tbody>
    </table>
  </div>
</script>



<script id="tmp-tag-manage-tr" type="text/html">
  <tr id="tag-manage-tr-${tag.id}">
    <td>
      <span>${tag.id}</span>
    </td>
    <td>
      <span>${tag.content}</span>
    </td>
    <td>
      <span class="btn radiusBtn style_8 square auto p-adm f-del-tag" id="f-del-tag-${tag.id}" data-id="${tag.id}">删除</span>
    </td>
  </tr>
</script>

<div id="tmp-tag-add-tr">
  <tr>
    <td>

    </td>
    <td>
      <input type="text" class="form-text inline-ele" id="f-add-tag-name"/>
    </td>
    <td>
      <span class="btn radiusBtn style_1 square auto p-adm f-add-tag-btn">添加标签</span>
    </td>
  </tr>
</div>

</body>
</html>